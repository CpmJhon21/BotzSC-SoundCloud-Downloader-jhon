<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BotzApi Upload</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#050505;--card:#0c0c0c;--border:#2a2a2a;--text:#e5e5e5;
      --muted:#9ca3af;--green:#4ade80;--green-dark:#22c55e;--red:#991b1b;
    }
    *{box-sizing:border-box;font-family:'Inter',sans-serif}
    body{margin:0;background:radial-gradient(circle at top,#0b0b0b,#000);color:var(--text)}
    header{padding:16px 20px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid var(--border)}
    .logo{color:var(--green);font-weight:700;font-size:22px}
    .menu{font-size:28px;color:var(--green)}
    .container{max-width:480px;margin:30px auto;padding:0 16px}
    .dropzone{background:linear-gradient(180deg,#0e0e0e,#070707);border:2px dashed var(--border);border-radius:18px;padding:36px 20px;text-align:center}
    .dropzone h2{margin:12px 0 6px;font-size:22px}
    .dropzone p{margin:0;color:var(--muted)}
    .btn{margin-top:18px;background:#1f2937;border:none;color:#fff;padding:10px 18px;border-radius:10px;font-size:15px}
    .history{margin-top:26px;background:var(--card);border-radius:16px;padding:16px}
    .history h3{margin:0 0 12px}
    .item{display:flex;justify-content:space-between;align-items:center;font-size:14px;margin-bottom:8px}
    .actions button{border:none;border-radius:10px;padding:8px 10px;margin-left:6px}
    .copy{background:#1f2937;color:#fff}
    .delete{background:var(--red);color:#fff}
    .result{background:var(--card);border-radius:20px;padding:20px;margin-top:24px;text-align:center}
    .result h2{color:var(--green);margin:0}
    .preview img{max-width:100%;border-radius:14px;margin-top:16px}
    .modal{position:fixed;inset:0;background:rgba(0,0,0,.7);display:none;align-items:center;justify-content:center}
    .modal-box{background:#0b0b0b;border-radius:18px;padding:24px;width:90%;max-width:320px;text-align:center}
    .modal-box h2{color:var(--green)}
    .modal-box button{margin:8px;border:none;border-radius:10px;padding:10px 16px}
    .yes{background:var(--green-dark);color:#000}
    .no{background:#374151;color:#fff}
    footer{margin:60px 0 20px;text-align:center;color:var(--muted);font-size:13px}
  </style>
</head>
<body>
<header><div class="logo">BotzApi</div><div class="menu">‚ò∞</div></header>
<div class="container">
  <div class="dropzone" id="dropzone">
    ‚¨ÜÔ∏è
    <h2>Drag & Drop or Click to Upload</h2>
    <p>Max 100MB</p>
    <button class="btn" onclick="fileInput.click()">Select File</button>
    <input type="file" id="fileInput" hidden />
  </div>

  <div id="result"></div>

  <div class="history"><h3>Upload History</h3><div id="historyList"></div></div>
</div>

<div class="modal" id="modal">
  <div class="modal-box">
    <h2>Are you sure?</h2>
    <p>This file will be deleted</p>
    <button class="yes" id="confirmDelete">Yes, delete</button>
    <button class="no" onclick="closeModal()">Cancel</button>
  </div>
</div>

<footer>¬© 2025 BotzAku. All rights reserved.</footer>

<script>
const fileInput = document.getElementById('fileInput');
const dropzone = document.getElementById('dropzone');
const result = document.getElementById('result');
const historyList = document.getElementById('historyList');
const modal = document.getElementById('modal');
let deleteTarget = null;

fileInput.addEventListener('change',()=>upload(fileInput.files[0]));
dropzone.addEventListener('dragover',e=>e.preventDefault());
dropzone.addEventListener('drop',e=>{e.preventDefault();upload(e.dataTransfer.files[0]);});

function upload(file){
  if(!file) return;
  const formData = new FormData();
  formData.append('file', file);

  fetch('https://api.botzaku.eu.org/api/upload',{
    method:'POST',
    body: formData
  })
  .then(res=>res.json())
  .then(data=>{
    console.log('API RESPONSE:', data);

    // FIX TOTAL SESUAI RESPONSE API BOTZAKU
    // Response asli: { status: true, result: "https://..." }
    const url = typeof data.result === 'string' ? data.result : '';

    if(!url){
      alert('Upload sukses tapi URL tidak ditemukan');
      return;
    }

    showResult(file, url);
    addHistory(file, url);
  })
  .catch(()=>alert('Upload gagal'));
}

function showResult(file,url){
  result.innerHTML=`<div class="result"><h2>Upload Successful</h2><p>${file.name}</p><div class="preview"><img src="${url}"></div><div style="margin-top:12px"><button class="copy" onclick="navigator.clipboard.writeText('${url}')">Copy</button></div></div>`;
}

function addHistory(file,url){
  const div=document.createElement('div');div.className='item';
  div.innerHTML=`<span>${file.name}</span><div class="actions"><button class="copy" onclick="navigator.clipboard.writeText('${url}')">üìã</button><button class="delete" onclick="openModal(this)">üóë</button></div>`;
  historyList.prepend(div);
}

function openModal(btn){deleteTarget=btn.closest('.item');modal.style.display='flex'}
function closeModal(){modal.style.display='none'}
document.getElementById('confirmDelete').onclick=()=>{deleteTarget.remove();closeModal()};
</script>
</body>
</html>
