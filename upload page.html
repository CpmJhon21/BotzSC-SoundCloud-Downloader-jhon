<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BotzApi Upload</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0b0b0b;--card:#121212;--border:#2a2a2a;--green:#66ff99;
      --text:#eaeaea;--muted:#9a9a9a;--danger:#8b1d1d;
    }
    *{box-sizing:border-box;font-family:Inter,system-ui}
    body{margin:0;background:var(--bg);color:var(--text)}
    header{padding:16px 20px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between}
    .logo{color:var(--green);font-weight:700;font-size:20px}
    main{padding:20px;max-width:520px;margin:auto}

    /* Drop area */
    .drop{border:2px dashed var(--border);border-radius:16px;padding:36px 20px;text-align:center;background:#121212;transition:all .25s ease}
    .drop.drag{border-color:var(--green);background:#101010;transform:scale(1.02)}

    input[type=file]{display:none}
    .btn{padding:12px 18px;border-radius:10px;border:none;background:#1f1f1f;color:#fff;font-weight:600;cursor:pointer}

    /* Progress */
    .progress{height:8px;border-radius:8px;background:#1f1f1f;margin-top:16px;overflow:hidden;display:none}
    .progress div{height:100%;width:0;background:var(--green);transition:width .4s ease}

    /* Preview */
    .preview{margin-top:16px;display:none;animation:fadeUp .4s ease}
    .preview img{width:100%;border-radius:12px}

    /* Card */
    .card{background:var(--card);border-radius:16px;padding:16px;margin-top:24px;animation:fadeUp .5s ease}
    table{width:100%;font-size:14px;border-collapse:collapse}
    th,td{padding:8px 4px;border-bottom:1px solid var(--border)}
    th{color:var(--muted)}

    /* Skeleton */
    .skeleton{height:14px;background:linear-gradient(90deg,#1a1a1a,#2a2a2a,#1a1a1a);background-size:200% 100%;animation:skeleton 1.2s infinite;border-radius:6px}

    /* Toast */
    .toast{position:fixed;bottom:20px;left:50%;transform:translateX(-50%) translateY(20px);background:#1f1f1f;color:var(--green);padding:12px 18px;border-radius:12px;opacity:0;transition:.3s;z-index:999}
    .toast.show{opacity:1;transform:translateX(-50%) translateY(0)}

    /* Animations */
    @keyframes fadeUp{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:none}}
    @keyframes skeleton{0%{background-position:200%}100%{background-position:-200%}}
  </style>
</head>
<body>
<header><div class="logo">BotzApi</div></header>
<main>
  <div class="drop" id="drop">
    <div style="font-size:40px">‚¨Ü</div>
    <h2>Drag & Drop or Click to Upload</h2>
    <p class="muted">Max 100MB</p>
    <label class="btn">Select File<input type="file" id="fileInput"></label>
    <div class="preview" id="preview"><img id="previewImg"></div>
    <div class="progress" id="progress"><div></div></div>
  </div>

  <div class="card">
    <h3>Upload History</h3>
    <table>
      <thead><tr><th>Name</th><th>Size</th><th>Date</th><th>Actions</th></tr></thead>
      <tbody id="history"></tbody>
    </table>
  </div>
</main>

<div class="toast" id="toast"></div>

<script>
const drop=document.getElementById('drop');
const fileInput=document.getElementById('fileInput');
const preview=document.getElementById('preview');
const previewImg=document.getElementById('previewImg');
const progress=document.getElementById('progress');
const bar=progress.firstElementChild;
const history=document.getElementById('history');
const toast=document.getElementById('toast');

function showToast(msg){toast.textContent=msg;toast.classList.add('show');setTimeout(()=>toast.classList.remove('show'),2200)}

function copyUrl(url){navigator.clipboard.writeText(url);showToast('URL Copied')}

async function deleteFile(url,btn){
  if(!confirm('Delete this file?')) return;
  try{
    await fetch(url);
    btn.closest('tr').remove();
    saveHistory();
    showToast('File Deleted');
  }catch(e){alert('Delete failed')}
}

(msg){toast.textContent=msg;toast.classList.add('show');setTimeout(()=>toast.classList.remove('show'),2500)}

['dragenter','dragover'].forEach(e=>drop.addEventListener(e,ev=>{ev.preventDefault();drop.classList.add('drag')}));
['dragleave','drop'].forEach(e=>drop.addEventListener(e,()=>drop.classList.remove('drag')));
drop.addEventListener('drop',e=>{e.preventDefault();handleFile(e.dataTransfer.files[0])});
fileInput.addEventListener('change',()=>handleFile(fileInput.files[0]));

async function handleFile(file){
  if(!file) return;

  preview.style.display='block';
  previewImg.src=URL.createObjectURL(file);

  progress.style.display='block';
  bar.style.width='30%';

  try{
    const fd=new FormData();fd.append('file',file);
    const res=await fetch('https://api.botzaku.eu.org/api/upload',{method:'POST',body:fd});
    const data=await res.json();

    bar.style.width='100%';
    setTimeout(()=>progress.style.display='none',400);
    if(!data.success) throw data.message;

    addHistory(data.file);
    saveHistory();
    showToast('Upload Successful');
    fileInput.value='';
  }catch(err){
    alert('Upload failed');
  }
}

function addHistory(f){
  const tr=document.createElement('tr');
  tr.innerHTML=`
    <td>${f.name}</td>
    <td>${f.size}</td>
    <td>${new Date(f.createdTime).toLocaleString()}</td>
    <td>
      <button class="btn" onclick="copyUrl('${f.url}')">üìã</button>
      <button class="btn" style="background:#8b1d1d" onclick="deleteFile('${f.deleteUrl}',this)">‚ùå</button>
    </td>`;
  history.prepend(tr);
}

function saveHistory(){localStorage.setItem('uploadHistory',history.innerHTML)}
function loadHistory(){const d=localStorage.getItem('uploadHistory');if(d)history.innerHTML=d}
loadHistory();
</script>
</body>
</html>
