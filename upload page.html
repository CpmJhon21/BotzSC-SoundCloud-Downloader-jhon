<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BotzApi Uploader</title>

  <!-- SweetAlert2 -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

  <style>
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu;background:#0b0b0b;color:#fff}
    a{text-decoration:none;color:inherit}

    /* NAVBAR */
    nav{background:#000;border-bottom:1px solid rgba(255,255,255,.1);position:relative;z-index:1000}
    .nav-container{max-width:1280px;margin:0 auto;padding:0 1.5rem;display:flex;align-items:center;justify-content:space-between;height:4rem}
    .logo{display:flex;align-items:center;gap:.6rem;font-weight:700;cursor:pointer}
    .logo img{height:32px}
    .nav-links{display:flex;gap:1.2rem}
    .nav-links a{color:#aaa}
    .nav-links a:hover{color:#98ff98}

    .hamburger{display:none;flex-direction:column;gap:5px;cursor:pointer}
    .hamburger span{height:3px;width:25px;background:#98ff98;transition:.3s}
    .hamburger.active span:nth-child(1){transform:rotate(45deg) translate(5px,5px)}
    .hamburger.active span:nth-child(2){opacity:0}
    .hamburger.active span:nth-child(3){transform:rotate(-45deg) translate(5px,-5px)}

    .mobile-menu{display:none;background:#000;padding:1rem;border-top:1px solid rgba(255,255,255,.1)}
    .mobile-menu.active{display:grid;gap:1.5rem;grid-template-columns:repeat(auto-fit,minmax(150px,1fr))}
    .mobile-menu h3{margin:0 0 .5rem}
    .mobile-menu a{display:block;color:#aaa;margin:.25rem 0}
    .mobile-menu a:hover{color:#98ff98}

    main{max-width:900px;margin:2rem auto;padding:0 1rem}

    /* UPLOADER */
    .drop-zone{border:2px dashed #333;border-radius:16px;padding:2rem;text-align:center;cursor:pointer;transition:.3s}
    .drop-zone:hover{border-color:#98ff98;background:rgba(152,255,152,.05)}
    .drop-zone input{display:none}

    .progress-wrap{display:none;margin-top:1rem}
    .progress-bar{height:8px;background:#222;border-radius:999px;overflow:hidden}
    .progress{height:100%;width:0;background:#98ff98;transition:.2s}

    .result-card{margin-top:1.5rem;padding:1rem;border-radius:16px;background:rgba(255,255,255,.05)}
    .result-actions{display:flex;gap:.5rem;flex-wrap:wrap;margin-top:1rem}
    .btn{padding:.45rem .8rem;border-radius:8px;border:none;cursor:pointer;background:#222;color:#fff}
    .btn:hover{background:#333}

    /* HISTORY */
    .upload-history{margin-top:3rem}
    table{width:100%;border-collapse:collapse}
    th,td{padding:.6rem;text-align:left;border-bottom:1px solid rgba(255,255,255,.1);white-space:nowrap}
    .history-actions{display:flex;gap:6px}
    .history-actions button{width:34px;height:34px;display:flex;align-items:center;justify-content:center;border-radius:8px}

    /* FOOTER */
    footer{background:#000;border-top:1px solid rgba(255,255,255,.1);padding:3rem 1rem 1.5rem;margin-top:4rem}
    .footer-grid{max-width:1280px;margin:0 auto;display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:2rem;text-align:center}
    .footer-info p{color:#aaa}
    .footer-links a{display:block;color:#aaa;margin:.3rem 0}
    .footer-links a:hover{color:#98ff98}
    .footer-bottom{text-align:center;margin-top:2rem;color:#777;font-size:.85rem}

    @media(max-width:768px){
      .nav-links{display:none}
      .hamburger{display:flex}
      table,thead,tbody,tr,th,td{display:block}
      thead{display:none}
      tr{margin-bottom:1rem;background:rgba(255,255,255,.05);padding:.8rem;border-radius:12px}
      td{display:flex;justify-content:space-between}
      td::before{content:attr(data-label);opacity:.6}
    }
  </style>
</head>
<body>

<nav>
  <div class="nav-container">
    <div class="logo" onclick="location.href='https://host.optikl.ink'">
      <img src="https://cdn.botzaku.eu.org/1dgrg_UmOtvHsMwCfoK0eYgdulOD-pa6G">
      <span>BotzYT</span>
    </div>
    <div class="nav-links">
      <a href="https://host.optikl.ink/docs">Docs</a>
      <a href="/web">Tools</a>
      <a href="https://host.optikl.ink/upload">Uploader</a>
      <a href="https://riskynd.eu.org/website">Other</a>
      <a href="https://host.optikl.ink/terms">Terms</a>
      <a href="https://host.optikl.ink/privacy">Privacy</a>
    </div>
    <div class="hamburger" id="hamburger"><span></span><span></span><span></span></div>
  </div>
  <div class="mobile-menu" id="mobileMenu">
    <div>
      <h3>Resources</h3>
      <a href="https://host.optikl.ink/docs">Docs</a>
      <a href="/web">Tools</a>
      <a href="https://host.optikl.ink/upload">Uploader</a>
    </div>
    <div>
      <h3>Legal</h3>
      <a href="https://host.optikl.ink/terms">Terms</a>
      <a href="https://host.optikl.ink/privacy">Privacy</a>
    </div>
  </div>
</nav>

<main>
  <div class="drop-zone" id="dropZone">
    <p>Click or drop file here</p>
    <input type="file" id="fileInput" />
  </div>

  <div class="progress-wrap" id="progressWrap">
    <div class="progress-bar"><div class="progress" id="progress"></div></div>
  </div>

  <div id="uploadResult"></div>

  <div class="upload-history">
    <h3>Upload History</h3>
    <table>
      <thead><tr><th>Name</th><th>Size</th><th>Date</th><th>Actions</th></tr></thead>
      <tbody id="historyBody"></tbody>
    </table>
  </div>
</main>

<footer>
  <div class="footer-grid">
    <div class="footer-info">
      <div class="logo"><span>BotzApi</span></div>
      <p>Empowering developers with reliable API solutions.</p>
    </div>
    <div class="footer-links">
      <h3>Resources</h3>
      <a href="https://host.optikl.ink/docs">Docs</a>
      <a href="https://host.optikl.ink/upload">Uploader</a>
    </div>
    <div class="footer-links">
      <h3>Legal</h3>
      <a href="https://host.optikl.ink/terms">Terms</a>
      <a href="https://host.optikl.ink/privacy">Privacy</a>
    </div>
  </div>
  <div class="footer-bottom">Â© <span id="year"></span> BotzApi</div>
</footer>

<script>
/* NAV */
const hamburger=document.getElementById('hamburger');
const mobileMenu=document.getElementById('mobileMenu');
hamburger.onclick=()=>{hamburger.classList.toggle('active');mobileMenu.classList.toggle('active')}

document.getElementById('year').textContent=new Date().getFullYear();

/* SWEETALERT TOAST */
const Toast=Swal.mixin({toast:true,position:'top',showConfirmButton:false,timer:2200});

/* UPLOADER */
const dropZone=document.getElementById('dropZone');
const fileInput=document.getElementById('fileInput');
const progressWrap=document.getElementById('progressWrap');
const progress=document.getElementById('progress');
const uploadResult=document.getElementById('uploadResult');
const historyBody=document.getElementById('historyBody');

let history=JSON.parse(localStorage.getItem('uploadHistory')||'[]');
renderHistory();

dropZone.onclick=()=>fileInput.click();
dropZone.ondragover=e=>{e.preventDefault()};
dropZone.ondrop=e=>{e.preventDefault();uploadFile(e.dataTransfer.files[0])};
fileInput.onchange=e=>uploadFile(e.target.files[0]);

function uploadFile(file){
  if(!file)return Toast.fire({icon:'warning',title:'No file selected'});

  const fd=new FormData();fd.append('file',file);
  const xhr=new XMLHttpRequest();
  xhr.open('POST','https://api.botzaku.eu.org/api/upload');

  progressWrap.style.display='block';

  xhr.upload.onprogress=e=>{progress.style.width=(e.loaded/e.total*100)+'%'};

  xhr.onload=()=>{
    const res=JSON.parse(xhr.responseText||'{}');
    progressWrap.style.display='none';progress.style.width='0';
    if(!res.success)return Toast.fire({icon:'error',title:'Upload failed'});

    Toast.fire({icon:'success',title:'Upload successful'});

    history.unshift(res.file);
    localStorage.setItem('uploadHistory',JSON.stringify(history));
    renderHistory();

    uploadResult.innerHTML=`<div class="result-card">
      <strong>${res.file.name}</strong>
      <div class="result-actions">
        <button class="btn" onclick="copyLink('${res.file.url}')">Copy</button>
        <button class="btn" onclick="doneUpload()">Done</button>
        <button class="btn" onclick="deleteFile('${res.file.deleteUrl}')">Delete</button>
      </div>
    </div>`;
  };

  xhr.onerror=()=>Toast.fire({icon:'error',title:'Network error'});
  xhr.send(fd);
}

function renderHistory(){
  historyBody.innerHTML='';
  history.forEach((f,i)=>{
    historyBody.innerHTML+=`<tr>
      <td data-label="Name">${f.name}</td>
      <td data-label="Size">${f.size}</td>
      <td data-label="Date">${new Date(f.createdTime).toLocaleString()}</td>
      <td data-label="Actions">
        <div class="history-actions">
          <button onclick="copyLink('${f.url}')"><i class="bi bi-clipboard"></i></button>
          <button onclick="infoFile(${i})"><i class="bi bi-info-circle"></i></button>
          <button onclick="deleteFile('${f.deleteUrl}',${i})"><i class="bi bi-trash"></i></button>
        </div>
      </td>
    </tr>`;
  });
}

function copyLink(url){navigator.clipboard.writeText(url);Toast.fire({icon:'success',title:'Copied'})}
function doneUpload(){uploadResult.innerHTML='';fileInput.value='';Toast.fire({icon:'info',title:'Ready'})}

function deleteFile(url,i){
  Swal.fire({title:'Are you sure?',icon:'warning',showCancelButton:true}).then(r=>{
    if(!r.isConfirmed)return;
    fetch(url).catch(()=>{});
    if(i!==undefined){history.splice(i,1);localStorage.setItem('uploadHistory',JSON.stringify(history));renderHistory()}
    uploadResult.innerHTML='';Toast.fire({icon:'success',title:'Deleted'})
  })
}

function infoFile(i){const f=history[i];Swal.fire({title:'File Info',html:`<pre style="text-align:left">Name: ${f.name}
Size: ${f.size}
Type: ${f.mimeType}
ID: ${f.id}
URL: ${f.url}</pre>`,background:'#000',color:'#fff'})}
</script>

</body>
</html>
